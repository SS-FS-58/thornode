version: '3'

services:
  binance:
    hostname: binance-fullnode
    image: binance-fullnode
    build:
      context: ../binance
      dockerfile: ../binance/Dockerfile
    volumes:
      - /opt/binance-data:/opt/bnbchaind

  node1:
    hostname: node1
    build:
      context: ../..
      dockerfile: ./Dockerfile
    image: thornode
    environment:
      - NODES=4
    entrypoint:
      /build/entrypoint.sh
    links:
      - node2
      - node3
      - node4
    volumes:
      - /tmp/genesis:/tmp/shared
      - .:/build
    command: ["supervisord", "-c", "/etc/supervisor.conf"]

  node2:
    hostname: node2
    build:
      context: ../..
      dockerfile: ./Dockerfile

    image: thornode
    environment:
      - NODES=4
    entrypoint:
      /build/entrypoint.sh
    volumes:
      - /tmp/genesis:/tmp/shared
      - .:/build
    command: ["supervisord", "-c", "/etc/supervisor.conf"]

  node3:
    hostname: node3
    build:
      context: ../..
      dockerfile: ./Dockerfile
    image: thornode
    environment:
      - NODES=4
    entrypoint:
      /build/entrypoint.sh
    volumes:
      - /tmp/genesis:/tmp/shared
      - .:/build
    command: ["supervisord", "-c", "/etc/supervisor.conf"]

  node4:
    hostname: node4
    build:
      context: ../..
      dockerfile: ./Dockerfile
    image: thornode
    environment:
      - NODES=4
    entrypoint:
      /build/entrypoint.sh
    volumes:
      - /tmp/genesis:/tmp/shared
      - .:/build
    command: ["supervisord", "-c", "/etc/supervisor.conf"]
